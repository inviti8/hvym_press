<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <!-- <link href="https://sapphire-giant-butterfly-891.mypinata.cloud/ipfs/QmcJLBGNFb2UKFy3jspNfHk8wFCjhSsBDaQ2tWrASQBSYE" rel="shortcut icon" type="image/x-icon"/> -->
  <title>{{data.settings.siteName}}</title>
  <link rel="stylesheet" href="https://unpkg.com/onsenui/css/onsenui.css">
  <link rel="stylesheet" href="https://unpkg.com/onsenui/css/onsen-css-components.min.css">
  <script src="https://unpkg.com/onsenui/js/onsenui.min.js"></script>
  
  <!-- Google Fonts Loading -->
  {% if data.settings.fontSettings.enableCustomFonts %}
    {% if data.settings.customFonts.primary.source == 'google' %}
      <link rel="preconnect" href="https://fonts.googleapis.com">
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link href="https://fonts.googleapis.com/css2?family={{data.settings.customFonts.primary.family|replace(' ', '+')}}:wght@300;400;500;700&display={{data.settings.fontSettings.fontDisplay}}" rel="stylesheet">
    {% endif %}
    
    {% if data.settings.customFonts.heading.source == 'google' %}
      <link href="https://fonts.googleapis.com/css2?family={{data.settings.customFonts.heading.family|replace(' ', '+')}}:wght@400;600;700&display={{data.settings.fontSettings.fontDisplay}}" rel="stylesheet">
    {% endif %}
  {% endif %}
  <script src="https://cdnjs.cloudflare.com/ajax/libs/approvejs/3.1.2/approve.min.js" integrity="sha512-TmhOO3rUu5WfsLdsw9H1pB/p5/A/KnhydCuLNGlZoukfUUopMmA2sq6DWR9E+acuLB1DBk2A8cq63f7JMwHgVQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script type="module">
    window.fn = {};

    window.fn.open = function () {
      var menu = document.getElementById('menu');
      menu.open();
    };
    
    window.fn.load = function (page) {
      var menu = document.getElementById('menu');
      var myNavigator = document.getElementById('myNavigator');
      var tabbar = document.querySelector('ons-tabbar');
      var carousel = document.getElementById('carousel');
    
      // Handle different navigation types
      if (myNavigator) {
        // Standard navigator (splitter mode)
        if (menu) {
          menu.close();
        }
        
        if(carousel){
          fn.goToPageByName(page);
          myNavigator.popPage();
        }else{
          myNavigator.resetToPage(page, { animation: 'fade' });
        }
      } else if (tabbar) {
        // Tabs mode - extract page name and switch tabs
        var pageName = page.replace('.html', '');
        var targetTab = document.querySelector('ons-tab[page="' + pageName + '.html"]');
        if (targetTab) {
          tabbar.setActiveTab(targetTab);
        } else {
          console.warn('fn.load: Target tab not found for page:', page);
        }
      } else if (carousel) {
        // Carousel mode - extract page name and switch carousel
        var pageName = page.replace('.html', '');
        // Find carousel item index for the page
        var carouselItems = carousel.querySelectorAll('ons-carousel-item');
        for (var i = 0; i < carouselItems.length; i++) {
          var item = carouselItems[i];
          if (item.querySelector('[data-page-name="' + pageName + '"]')) {
            carousel.setActiveIndex(i);
            break;
          }
        }
      } else {
        console.warn('fn.load: No navigation component found, cannot load page:', page);
      }
    };

    window.fn.showDialog = function(id) {
      var dialog = document.getElementById(id);

      if (dialog) {
          dialog.show();
      } else {
        ons.createElement(id+'.html', { append: true })
          .then(function(dialog) {
              dialog.show();
            });
        }
    };

    window.fn.hideDialog = function(id) {
      document
        .getElementById(id)
        .hide();
    };

    window.fn.formStateHandler = function (form, state) {
        var buttons = form.querySelectorAll("button");
        for (var i = 0; i < buttons.length; i++) {
          buttons[i].disabled = state;
        }
    }

    window.fn.validateEmail = function (form) {
        var result = false;

        var rules = {
            required: true,
            email: true
        };

        var inputs = document.getElementsByTagName("input");
        var email = null;

        for (var i = 0; i < inputs.length; i++) {
            var input = inputs[i];

            if(input.name == "email"){
                email = input;
                break;
            }
        }

        if(email != null){
            result = approve.value(email.value, rules);
        }

        return result['approved'];
    }

    window.fn.validateFields = function (form) {
        var result = false;
        var results = []

        var rules = {
            required: true
        };

        var inputs = document.getElementsByTagName("input");
        var email = null;

        for (var i = 0; i < inputs.length; i++) {
            var input = inputs[i];
            results.push(approve.value(input.value, rules)['approved']);
        }

        for (var i = 0; i < results.length; i++) {
            var approved = results[i];

            if(approved == false){
                break;
            }

            result = approved;

        }


        return result;
    }

    ons.ready(function() {
      var myNavigator = document.getElementById('myNavigator');
      var tabbar = document.querySelector('ons-tabbar');
      var carousel = document.getElementById('carousel');
      var forms = document.getElementsByTagName("form");

      if(carousel){
        var back = document.getElementById("carousel-back-button");

        var toggle_back_btn = function() {
          var idx = carousel.getActiveIndex();
          console.log(idx)
          if(idx === 0){
            back.style.opacity = 0;
          }else{
            back.style.opacity = 1;
          };
        };

        var onload = function() {
          toggle_back_btn();
        };

        var onpostpush = function() {
          toggle_back_btn();
        };

        var onpostnavpush = function() {
          toggle_back_btn();
        };

        carousel.addEventListener('refresh', onload);
        carousel.addEventListener('postchange', onpostpush);
        
      };

      for (var i = 0; i < forms.length; i++) {
         var form = forms.item(i);

        form.onsubmit = function (e) {
            e.preventDefault();
            var fields_filled = fn.validateFields(form);
            var email_valid = fn.validateEmail(form);

            if(fields_filled){
                if(email_valid){
                    fn.showDialog('loading');
                    fn.formStateHandler(form, true);

                    fetch(form.action, {
                        method: "post", 
                        body: new FormData(form)
                    }).then(response => {
                        var form_id = form.id
                        var dlg_id = form_id.replace("form_", "dlg_")
                        fn.hideDialog('loading');
                        fn.showDialog(dlg_id);
                        fn.formStateHandler(form, false);
                    });

                }else{
                    alert('Email is invalid!');
                }

            }else{
                alert('Some fields are empty!');
            }
        }
      }

      {% if data.settings.pageType == 'carousel' %}
      window.fn.prev = function() {
        var carousel = document.getElementById('carousel');
        carousel.prev();
        fn.updateCarouselTitle();
      };

      window.fn.next = function() {
        var carousel = document.getElementById('carousel');
        carousel.next();
        fn.updateCarouselTitle();
      };

      window.fn.goToHome = function() {
        var carousel = document.getElementById('carousel');
        console.log('Go Home')
        if (carousel) {
          carousel.first();
          fn.updateCarouselTitle();
        }
      };

      window.fn.goToPage = function(index) {
        var carousel = document.getElementById('carousel');
        if (carousel) {
          carousel.setActiveIndex(index);
          fn.updateCarouselTitle();
        }
      };

      window.fn.goToPageByName = function(pageName) {
        var carousel = document.getElementById('carousel');
        console.log(pageName)
        if (carousel) {
          // Find the page index by name
          var pageIndex = -1;
          {% if data.hasHomePage %}
          if (pageName.includes('home') || pageName.includes('index')) {
            pageIndex = 0;
          } else {
          {% endif %}
          {% for page in data.pages %}
            if (pageName.includes('{{page.title}}')) {
              pageIndex = {% if data.hasHomePage %}{{loop.index}}{% else %}{{loop.index0}}{% endif %};
            }
          {% endfor %}
          {% if data.hasHomePage %}
          }
          {% endif %}
          
          if (pageIndex >= 0) {
            carousel.setActiveIndex(pageIndex);
            fn.updateCarouselTitle();
          }
        }
      };

      window.fn.updateCarouselTitle = function() {
        var carousel = document.getElementById('carousel');
        var titleElement = document.getElementById('carousel-title');
        if (carousel && titleElement) {
          var currentIndex = carousel.getActiveIndex();
          var titles = [
            {% if data.hasHomePage %}
            '{{data.homePage.title}}',
            {% endif %}
            {% for page in data.pages %}
            '{{page.title}}'{% if not loop.last %},{% endif %}
            {% endfor %}
          ];
          
          if (titles[currentIndex]) {
            titleElement.textContent = titles[currentIndex];
          }
        }
      };

             // Add event listener for carousel changes
       var carousel = document.getElementById('carousel');
       if (carousel) {
         carousel.addEventListener('postchange', function() {
           fn.updateCarouselTitle();
         });
       }
              {% endif %}
 
       {% if data.settings.pageType == 'tabs' %}
       window.fn.goToTabByName = function(pageName) {
         var tabbar = document.querySelector('ons-tabbar');
         if (tabbar) {
           // Find the tab index by name
           var tabIndex = -1;
           {% if data.hasHomePage %}
           if (pageName === 'home') {
             tabIndex = 0;
           } else {
           {% endif %}
           {% for page in data.pages %}
             if (pageName === '{{page.title}}') {
               tabIndex = {% if data.hasHomePage %}{{loop.index}}{% else %}{{loop.index0}}{% endif %};
             }
           {% endfor %}
           {% if data.hasHomePage %}
           }
           {% endif %}
           
           if(tabIndex === 0){
              var myNavigator = document.getElementById('myNavigator');
              if(myNavigator && myNavigator.pages.length > 0){
                myNavigator.popPage();
              };
              tabbar.setActiveTab(tabIndex);
            }else{
              tabbar.setActiveTab(tabIndex);
            };
         }
       };
       {% endif %}
 
               
 
     });

  </script>
  <style>
    /* Font CSS Variables */
    :root {
      {% if data.settings.fontSettings.enableCustomFonts %}
        --font-primary: '{{data.settings.customFonts.primary.family}}', {{data.settings.customFonts.primary.fallback}};
        --font-heading: '{{data.settings.customFonts.heading.family}}', {{data.settings.customFonts.heading.fallback}};
      {% else %}
        --font-primary: Arial, sans-serif;
        --font-heading: Helvetica, Arial, sans-serif;
      {% endif %}

      {{data.settings.css_components}}
      --outline-color: var(--highlight-color);
      --outline-color-faint: var(--border-color);
    }

    .card--outlined {
        border: 1px solid var(--outline-color);
        box-shadow: 0 0 2px hsla(0, 0%, 14%, 0.1), 
                 0 0 4px hsla(0, 0%, 45%, 0.156), 
                 0 0 6px hsla(0, 0%, 48%, 0.4);   
    }

    /* Apply fonts throughout the template */
    body { 
        font-family: var(--font-primary); 
    }
    
    h1, h2, h3, h4, h5, h6 { 
        font-family: var(--font-heading); 
    }
    
    .hero-title { 
        font-family: var(--font-heading); 
    }
    
    .hero-subtitle { 
        font-family: var(--font-heading); 
    }
    
    .title { 
        font-family: var(--font-heading); 
    }
    
    textarea {
        border: none;
        overflow: auto;
        outline: none;
    
        -webkit-box-shadow: none;
        -moz-box-shadow: none;
        box-shadow: none;
    }
    ons-list{
      opacity: 90%;
      border-radius: 6px !important;
    }
    ons-row{
        padding: {{data.settings.row_pad}}%;
    }
    ons-col, ons-card{
        min-width: 350px;
        margin: 0 auto;
    }
    ons-card, img{
        border-radius: 15px !important;
    }

    ons-toolbar{
      padding-top: 5px !important;
    }
    video {
      /* override other styles to make responsive */
      width: 100%    !important;
      height: auto   !important;
    }
    button {
          border-radius: 6px !important;
    }

    /* Apply the hover effect */
      ons-button {
        cursor: pointer;
        transition: transform .2s !important;
      }

      ons-button:hover {
        transform: scale(1.05);
      }

    .menu_icon{
      padding-right: 10px;
    }
    .author{
      padding-left: 10px;
    }
    .form_container{
      margin: 0 auto;
    }
    .form_list{
        width: 100%;
        margin: 0 auto;
        max-width: 350px;
        min-width: 250px;
    }
    .form_list_item{
        width: 100%;
        min-width:200px;
        margin: 0;
    }
    .form_input{
        width: 100%;
        min-width:250px;
        margin: 0 auto;
    }
    .article { 
        height: 200px; 
        width:100%; 
        overflow: scroll;
        outline: none;
    
        -webkit-box-shadow: none;
        -moz-box-shadow: none;
        box-shadow: none; 
      }
      .expanded_article {
        width: 80%;
        padding-left: 10%;
        padding-bottom: 5%;
        text-align: left;
      }

      .expanded_article_div {
        padding-top: 5vh;
      }
      .deployed_img_p{
        padding-left: 10%;
        padding-right: 10%;
        width: 80%;
      }
      .deployed_img{
        width: 100%;
      }
      .content_default{
        height: 200px;
      }
      .content_medium{
        height: 250px;
      }
      .content_tall{
        height: 300px;
      }
      .vid_container{
        margin: 0 auto;
        max-width: 80%;
        min-width: 250px;
      }
      
      /* Home Page Styles */
      .hero-section {
          min-height: 60vh;
          background: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), var(--hero-bg);
          background-size: cover;
          background-position: center;
          display: flex;
          align-items: center;
          justify-content: center;
          text-align: center;
          color: white;
          margin-bottom: 2rem;
          border-radius: 10px !important;
      }

      .hero-content {
          padding: 2rem;
      }

      .hero-title {
          font-size: 3rem;
          margin-bottom: 1rem;
          text-shadow: 1px 1px 1px rgba(0,0,0,0.3);
      }

      .hero-subtitle {
          font-size: 1.2rem;
          margin-bottom: 2rem;
          text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
      }

      .hero-cta {
          margin: 0.5rem;
          border-radius: 6px !important;
      }

      .home-navigation {
          text-align: center;
          padding: 2rem;
          display: flex;
          flex-wrap: wrap;
          justify-content: center;
          gap: 1.5rem;
      }

      .home-nav-button {
          margin: 0.5rem;
          border-radius: 6px !important;
          display: inline-flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          min-width: 120px;
          min-height: 60px;
          padding: 0.75rem 1rem;
      }

      .home-nav-button img {
          max-width: 128px;
          max-height: 128px;
          margin-bottom: 0.5rem;
          object-fit: contain;
      }

      .home-nav-button.image-button {
          min-width: auto;
          background: none;
          border: none;
          box-shadow: none;
          padding: 0.5rem;
      }

      .home-nav-button.image-button img {
          margin: 0;
      }

      .home-content {
           padding: 2rem;
           max-width: 800px;
           margin: 0 auto;
       }

       /* Feature Cards */
      .features {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
          gap: 1.5rem;
          padding: 2rem 1rem;
          max-width: 1200px;
          margin: 0 auto;
      }

      .feature-card {
          background: var(--background-color);
          border-radius: 8px;
          padding: 1.5rem;
          box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
          transition: transform 0.2s, box-shadow 0.2s;

      }

      .feature-card:hover {
          transform: translateY(-5px);
          box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
      }

      .feature-card h3 {
          font-size: 1.2rem;
          margin: 0 0 0.75rem 0;
          color: var(--text-color);
          display: flex;
          align-items: center;
          gap: 0.5rem;
      }

      .feature-card p {
          margin: 0;
          color: var(--text-secondary-color);
          line-height: 1.6;
      }

      .feature-icon {
          font-size: 1.5rem;
          margin-right: 0.5rem;
      }

      .section-title {
          text-align: center;
          font-size: 2rem;
          margin: 3rem 0 1.5rem;
          color: var(--text-color);
          position: relative;
          padding-bottom: 1rem;
      }

      .section-title:after {
          content: '';
          display: block;
          width: 60px;
          height: 3px;
          background: var(--primary-color);
          margin: 0.5rem auto 0;
          border-radius: 3px;
      }

       /* Carousel-specific styles for proper scrolling */
       .carousel-content-container {
           height: calc(100vh - 120px); /* Account for toolbar height */
           overflow-y: auto;
           overflow-x: hidden;
           padding: 20px;
           -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */
       }

       .carousel-item-content {
           min-height: 100%;
           position: relative;
       }

       /* Ensure fab buttons are always visible and clickable */
       .carousel-fab {
           position: relative !important;
           z-index: 1000 !important;
           touch-action: manipulation !important;
           pointer-events: auto !important;
           -webkit-touch-callout: none !important;
           -webkit-user-select: none !important;
           -khtml-user-select: none !important;
           -moz-user-select: none !important;
           -ms-user-select: none !important;
           user-select: none !important;
       }
       
       /* Disable carousel touch events on interactive elements */
       .carousel-fab * {
           pointer-events: auto !important;
           touch-action: manipulation !important;
       }
       .article-nav-button {
            float: right;
            margin: 1em 0;
        }
        /* Carousel feature cards layout */
        .carousel-content-container .hero-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            max-width: 100%;
            padding: 1rem;
        }

        .carousel-content-container .feature-card {
            border-radius: 8px;
            padding: 1rem;
            margin: 0.5rem;
            width: 280px;
        }

        .carousel-content-container .features {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 1.5rem;
            width: 100%;
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1rem;
        }

        .carousel-content-container .features-section {
            width: 100%;
            margin: 2rem 0;
        }

        /* Ensure text is readable on light backgrounds */
        .carousel-content-container .feature-card h3 {
            color: #333;
            margin: 0 0 0.5rem 0;
            font-size: 1.1rem;
        }

        .carousel-content-container .feature-card p {
            color: #666;
            margin: 0;
            font-size: 0.9rem;
        }

        /* Make sure the carousel content is scrollable */
        .carousel-item-content {
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .carousel-content-container .features {
                flex-direction: column;
                align-items: center;
            }
            
            .carousel-content-container .feature-card {
                width: 100%;
                max-width: 350px;
            }
        }
     </style>

</head>
<body>
{% if data.settings.pageType == 'splitter' %}
<!-- Splitter Navigation Structure -->
<ons-splitter>
  <ons-splitter-side id="menu" side="left" width="220px" collapse swipeable>
    <ons-page>
      <ons-list>
        {% if data.hasHomePage %}
        <ons-list-item onclick="fn.load('home.html')" tappable>
          <ons-icon class='menu_icon' icon="md-home"></ons-icon>
          <p>Home</p>
        </ons-list-item>
        {% endif %}
        {% for page in data.pages %}
          {% if page.icon != 'none' %}
        <ons-list-item onclick="fn.load('{{page.title}}.html')" tappable>
          <ons-icon class='menu_icon' icon="{{page.icon}}"></ons-icon>
            {% if page.use_text %}
              <p>{{page.title}}</p>
            {% endif %}
        </ons-list-item>
          {% else %}
        <ons-list-item onclick="fn.load('{{page.title}}.html')" tappable>
          {{page.title}}
        </ons-list-item>
          {% endif %}
        {% endfor %}
      </ons-list>
    </ons-page>
  </ons-splitter-side>
  <ons-splitter-content>
    {% if data.hasHomePage %}
      <ons-navigator id="myNavigator" page="home.html"></ons-navigator>
    {% else %}
      <ons-navigator id="myNavigator" page="{{data.pages[0].title}}.html"></ons-navigator>
    {% endif %}
  </ons-splitter-content>
</ons-splitter>
{% endif %}

{% if data.settings.pageType == 'tabs' %}
{% if data.hasHomePage %}
<ons-navigator id="myNavigator" hide-toolbar=false>
{% else %}
<ons-navigator id="myNavigator" page="{{data.pages[0].title}}.html" hide-toolbar=false>
{% endif %}
<ons-toolbar modifier="{{data.settings.style}}">
{% if data.settings.siteLogo %}
    <img src="{{data.settings.siteLogo}}"
        {% if data.hasHomePage %}
          onclick="fn.goToTabByName('home')"
        {% endif %}
        alt="{{data.settings.siteName}} Logo" 
        style="height: 32px; width: auto; max-width: 120px; object-fit: contain; margin-top: 5px; margin-right: 10px; margin-left: 10px;">
{% else %}
    <ons-toolbar-button id="tabs-home-button" onclick="fn.goToTabByName('home')">
        <ons-icon icon="chevron-left"></ons-icon>
    </ons-toolbar-button>
{% endif %}

</ons-toolbar>
  <ons-page>
    <ons-tabbar swipeable position="auto">
      {% if data.hasHomePage %}
        <ons-tab page="tabs-home.html" label="Home" icon="md-home" active></ons-tab>
      {% endif %}
      {% for page in data.pages %}
        {% if page.icon != 'none' %}
          {% if page.use_text %}
      <ons-tab page="{{page.title}}.html" label="{{page.title}}" icon="{{page.icon}}"></ons-tab>
          {% else %}
      <ons-tab page="{{page.title}}.html" icon="{{page.icon}}"></ons-tab>
          {% endif %}
        {% else %}
      <ons-tab page="{{page.title}}.html" label="{{page.title}}"></ons-tab> 
        {% endif %}
      {% endfor %}
    </ons-tabbar>
  </ons-page>
</ons-navigator>
{% endif %}

{% if data.settings.pageType == 'carousel' %}
<ons-navigator id="myNavigator" page="carousel-home.html">
  <ons-page>
    <ons-toolbar modifier="{{data.settings.style}}">
      <div class="left">
        <ons-toolbar-button id="carousel-back-button" onclick="fn.prev()">
            <ons-icon icon="md-chevron-left" size="30px"></ons-icon>
        </ons-toolbar-button>
        
        {% if data.settings.siteLogo %}
          <img src="{{data.settings.siteLogo}}"
              {% if data.hasHomePage %}
              onclick="fn.goToHome()"
              {% endif %}
              alt="{{data.settings.siteName}} Logo" 
              style="height: 32px; width: auto; max-width: 120px; object-fit: contain; margin-top: 5px; margin-right: 10px; margin-left: 10px;">
        {% else %} 
        <ons-toolbar-button onclick="fn.goToHome()">
            {% if data.hasHomePage %}
            <ons-toolbar-button onclick="fn.goToHome()">
                <ons-icon icon="md-home"></ons-icon>
            </ons-toolbar-button>
            {% endif %}
        {% endif %}
      </div>
      <div class="center">
        <span id="carousel-title">
          {% if data.hasHomePage %}
            {{data.homePage.title}}
          {% else %}
            {{data.pages[0].title}}
          {% endif %}
        </span>
      </div>
      <div class="right">
        <ons-toolbar-button onclick="fn.next()">
           <ons-icon icon="md-chevron-right" size="30px"></ons-icon>
      </ons-toolbar-button>
    </div>
    </ons-toolbar>
    
    <ons-carousel fullscreen swipeable auto-scroll overscrollable id="carousel">
    {% if data.hasHomePage %}
    <ons-carousel-item>
      <div class="carousel-content-container">
        <div class="carousel-item-content" style="text-align: center">
          <ons-row>
            <ons-col width="100%">
              {% if data.homePage.content.hero_title or data.homePage.content.hero_image %}
              <div class="hero-section" {% if data.homePage.content.hero_image %}style="background-image: url('{{data.homePage.content.hero_image}}')"{% endif %}>
                <div class="hero-content">

                  {% if data.homePage.content.hero_title %}
                  <h1 class="hero-title">{{data.homePage.content.hero_title}}</h1>
                  {% endif %}

                  {% if data.homePage.content.hero_subtitle %}
                  <p class="hero-subtitle">{{data.homePage.content.hero_subtitle}}</p>
                  {% endif %}

                  {% if data.homePage.content.cta_button.text %}
                  <ons-button onclick="fn.goToPage(1)" modifier="large" class="hero-cta">
                    {{data.homePage.content.cta_button.text}}
                  </ons-button>
                  {% endif %}

                <!-- Navigation Buttons (from frontmatter) -->
                {% if data.homePage.navigation %}
                <div class="home-navigation">
                  {% for nav_item in data.homePage.navigation %}
                  {% if data.settings.pageType == 'splitter' %}
                    <ons-button onclick="fn.load('{{nav_item.page}}.html')"
                  {% endif %}
                  {% if data.settings.pageType == 'carousel' %}
                    <ons-button onclick="fn.goToPageByName('{{nav_item.page}}')"
                  {% endif %}
                  {% if data.settings.pageType == 'tabs' %}
                    <ons-button onclick="fn.goToTabByName('{{nav_item.page}}')"
                  {% endif %}
                                modifier="{{nav_item.style or 'primary'}}" 
                                class="home-nav-button {% if nav_item.image %}image-button{% endif %}"
                                title="{{nav_item.text or nav_item.alt or ''}}">
                      {% if nav_item.image %}
                        <img src="{{nav_item.image}}" alt="{{nav_item.alt or nav_item.text or ''}}" loading="lazy">
                      {% endif %}
                      {% if nav_item.text and not nav_item.hide_text %}
                        <span>{{nav_item.text}}</span>
                      {% endif %}
                    </ons-button>
                  {% endfor %}
                </div>
                {% endif %}

                  {% if data.homePage.content.features %}
                  <div class="features-section">
                    <div class="features">
                      {% for feature in data.homePage.content.features %}
                        <div class="feature-card">
                          <h3>
                            <span class="feature-icon">{{ feature.title.split(' ')[0] }}</span>
                            {{ feature.title.split(' ')[1:]|join(' ') }}
                          </h3>
                          <p>{{ feature.details }}</p>
                        </div>
                      {% endfor %}
                    </div>
                  </div>
                  {% endif %}
                  
                </div>
              </div>
              {% endif %}
              
              <div class="home-content">
                {{data.homePage.content.html|safe}}
              </div>
            </ons-col>
          </ons-row>
        </div>
      </div>
    </ons-carousel-item>
    {% endif %}
        {% for page in data.pages %}
    <ons-carousel-item>
      <div class="carousel-content-container">
        <div class="carousel-item-content" style="text-align: center">
          <ons-row>
            {% for column in page.content.columns %}
               <ons-col width="{{page.content.widths[loop.index0]}}%">
                    {% for card in column %}
                    {% if card.type == 'Form' %}
                      {% if card.bg_img != 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAACXBIWXMAAC4jAAAuIwF4pT92AAAADUlEQVQImWP4//8/AwAI/AL+hc2rNAAAAABJRU5ErkJggg==' %}
                        {% if card.use_color%}
                        <ons-card data-card-name="{{card.name}}" style="max-width:{{card.max_width}}%;  margin:0 auto; margin-bottom: 5px;"  modifier="{{data.settings.style}}" style="background-color: {{card.color}}; background: url('{{card.bg_img}}'); background-position:center; background-repeat:no-repeat; background-size:cover;">
                        {% else %}
                        <ons-card data-card-name="{{card.name}}" modifier="{{data.settings.style}}" style="max-width:{{card.max_width}}%;  margin:0 auto; margin-bottom: 5px; background: url('{{card.bg_img}}'); background-position:center; background-repeat:no-repeat; background-size:cover;">
                        {% endif %}
                      {% else %}
                    <ons-card data-card-name="{{card.name}}" style="max-width:{{card.max_width}}%;  margin:0 auto; margin-bottom: 5px;"  modifier="{{data.settings.style}}">
                      {% endif %}
                        <div class="title">
                          {{card.name}}
                        </div>
                          <div>
                            {% if card.use_color%}
                            <ons-list style="background-color: {{card.color}};" modifier="{{card.border}}">
                            {% else %}
                            <ons-list modifier="{{card.border}}">
                            {% endif %}
                              <ons-list-item>
                                  <div class="form_container">
                                    <br />
                                    {{card.html}}
                                  {% if card.form_id != ""%}
                                  <form class="gform" id="form_{{card.name}}" method="post" action="https://script.google.com/macros/s/{{card.form_id}}/exec">
                                    {% if card.use_color%}
                                    <ons-list style="background-color: {{card.color}};">
                                    {% else %}
                                      <ons-list class="form_list">
                                    {% endif %}
                                      {% for input in card.form_data %}
                                      <ons-list-item class="form_list_item">
                                        <ons-input class="form_input" id="{{input}}" name="{{input}}" modifier="underbar" placeholder="{{input}}" float></ons-input>
                                      </ons-list-item>
                                      {% endfor %}
                                    </ons-list>
                                    <button class="form_list button--large button" id="submit" type="submit">{{card.form_btn_txt}}</button>
                                    </form>
                                    {{card.form_html}}
                                  {% else %}
                                  <p>FORM ID IS NOT SET!!!</p>
                                  {% endif %}
                                  </div>
                              </ons-list-item>
                            </ons-list>
                          </div>
                        </ons-card>
                    {% else %}
                    {% if card.bg_img != 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAACXBIWXMAAC4jAAAuIwF4pT92AAAADUlEQVQImWP4//8/AwAI/AL+hc2rNAAAAABJRU5ErkJggg==' %}
                        {% if card.use_color%}
                        <ons-card data-card-name="{{card.name}}" modifier="{{data.settings.style}}" style="max-width:{{card.max_width}}%;  margin:0 auto; margin-bottom: 5px; background-color: {{card.color}}; background: url('{{card.bg_img}}'); background-position:center; background-repeat:no-repeat; background-size:cover;">
                        {% else %}
                        <ons-card data-card-name="{{card.name}}" modifier="{{data.settings.style}}" style="max-width:{{card.max_width}}%;  margin:0 auto; margin-bottom: 5px; background: url('{{card.bg_img}}'); background-position:center; background-repeat:no-repeat; background-size:cover;">
                        {% endif %}
                      {% else %}
                        {% if card.use_color%}
                        <ons-card data-card-name="{{card.name}}" style="max-width:{{card.max_width}}%;  margin:0 auto; margin-bottom: 5px; background-color: {{card.color}};" modifier="{{data.settings.style}}">
                        {% else %}
                        <ons-card data-card-name="{{card.name}}" style="max-width:{{card.max_width}}%;  margin:0 auto; margin-bottom: 5px;" modifier="{{data.settings.style}}">
                        {% endif %}
                      {% endif %}
                        <div class="title">
                          {{card.name}}
                        </div>
                          <div class="content">
                            {% if card.use_color%}
                            <ons-list style="background-color: {{card.color}};" modifier="{{card.border}}">
                            {% else %}
                            <ons-list modifier="{{card.border}}">
                            {% endif %}
                              {% if card.type == 'Expandable' %}
                              <ons-list-item expandable>
                              {% else %}
                              <ons-list-item expandable expanded class="list-item list-item--expandable expanded ">
                              {% endif %}
                              {% if card.use_thumb %}
                                {% if card.author_img != '' %}
                                <div class="left">
                                  <img class="list-item__thumbnail" src="{{card.author_img}}">
                                  <p class="list-item__subtitle author">{{card.author}}</p>
                                </div>
                                  {% endif %}
                                {% endif %}
                                <div class="expandable-content">
                                  <div class="article">
                                    <br />
                                    {{card.html}}
                                      {% if card.use_color%}
                                      <ons-list style="background-color: {{card.color}};">
                                      {% else %}
                                      <ons-list>
                                      {% endif %}
                                    </ons-list>
                                    {{card.form_html}}
                                  </div>
                                    <ons-fab onclick="myNavigator.pushPage('nav_{{card.name}}.html')" modifier="{{data.settings.style}}">
                                      <ons-icon icon="fa-chevron-left"></ons-icon>
                                    </ons-fab>
                                  </div>
                                </ons-list-item>
                              </ons-list>
                            </div>
                          </ons-card>
                    {% endif %}
                    {% endfor %}
               </ons-col>
            {% endfor %}
           </ons-row>
         </div>
      </div>
    </ons-carousel-item>
         {% endfor %}
   </ons-carousel>
   </ons-page>
 </ons-navigator>
 {% endif %}

<!-- Carousel Home Page Template -->
{% if data.settings.pageType == 'carousel' %}
<template id="carousel-home.html">
  <ons-page>
    <ons-toolbar modifier="{{data.settings.style}}">
      <div class="left">
        <ons-toolbar-button id="carousel-back-button" onclick="fn.prev()">
            <ons-icon icon="md-chevron-left" size="30px"></ons-icon>
        </ons-toolbar-button>

        {% if data.settings.siteLogo %}
          <img src="{{data.settings.siteLogo}}"
              {% if data.hasHomePage %}
              onclick="fn.goToHome()"
              {% endif %}
              alt="{{data.settings.siteName}} Logo" 
              style="height: 32px; width: auto; max-width: 120px; object-fit: contain; margin-top: 5px; margin-right: 10px; margin-left: 10px;">
        {% else %}
          {% if data.hasHomePage %}
          <ons-toolbar-button onclick="fn.goToHome()">
              <ons-icon icon="md-home"></ons-icon>
          </ons-toolbar-button>
          {% endif %}
        {% endif %}
        
      </div>
      <div class="center">
        <span id="carousel-title">
          {% if data.hasHomePage %}
            {{data.homePage.title}}
          {% else %}
            {{data.pages[0].title}}
          {% endif %}
        </span>
      </div>
      <div class="right">
        <ons-toolbar-button id="carousel-next-button" onclick="fn.next()">
           <ons-icon icon="md-chevron-right" size="30px"></ons-icon>
      </ons-toolbar-button>
    </div>
    </ons-toolbar>
    
    <ons-carousel fullscreen swipeable auto-scroll overscrollable id="carousel">
      {% if data.hasHomePage %}
      <ons-carousel-item>
        <div class="carousel-content-container">
          <div class="carousel-item-content" style="text-align: center">
            <ons-row>
              <ons-col width="100%">
                {% if data.homePage.content.hero_title or data.homePage.content.hero_image %}
                <div class="hero-section" {% if data.homePage.content.hero_image %}style="background-image: url('{{data.homePage.content.hero_image}}')"{% endif %}>
                  <div class="hero-content">
                    {% if data.homePage.content.hero_title %}
                    <h1 class="hero-title">{{data.homePage.content.hero_title}}</h1>
                    {% endif %}
                    {% if data.homePage.content.hero_subtitle %}
                    <p class="hero-subtitle">{{data.homePage.content.hero_subtitle}}</p>
                    {% endif %}
                    {% if data.homePage.content.cta_button.text %}
                    <ons-button onclick="fn.goToPage(1)" modifier="large" class="hero-cta">
                      {{data.homePage.content.cta_button.text}}
                    </ons-button>
                    {% endif %}
                  </div>
                </div>
                {% endif %}

                <!-- Navigation Buttons (from frontmatter) -->
                {% if data.homePage.navigation %}
                  {% for nav_item in data.homePage.navigation %}
                    <ons-button onclick="fn.goToPageByName('{{nav_item.page}}')" 
                                modifier="{{nav_item.style or 'primary'}}" 
                                class="home-nav-button">
                      {{nav_item.text}}
                    </ons-button>
                  {% endfor %}
                </div>
                {% endif %}
                
                <div class="home-content">
                  {{data.homePage.content.html|safe}}
                </div>
              </ons-col>
            </ons-row>
          </div>
        </div>
      </ons-carousel-item>
      {% endif %}
      {% for page in data.pages %}
      <ons-carousel-item>
        <div class="carousel-content-container">
          <div class="carousel-item-content" style="text-align: center">
            <ons-row>
              {% for column in page.content.columns %}
                 <ons-col width="{{page.content.widths[loop.index0]}}%">
                      {% for card in column %}
                      {% if card.type == 'Form' %}
                        {% if card.bg_img != 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAACXBIWXMAAC4jAAAuIwF4pT92AAAADUlEQVQImWP4//8/AwAI/AL+hc2rNAAAAABJRU5ErkJggg==' %}
                          {% if card.use_color%}
                          <ons-card data-card-name="{{card.name}}" style="max-width:{{card.max_width}}%;  margin:0 auto; margin-bottom: 5px;"  modifier="{{data.settings.style}}" style="background-color: {{card.color}}; background: url('{{card.bg_img}}'); background-position:center; background-repeat:no-repeat; background-size:cover;">
                          {% else %}
                          <ons-card data-card-name="{{card.name}}" modifier="{{data.settings.style}}" style="max-width:{{card.max_width}}%;  margin:0 auto; margin-bottom: 5px; background: url('{{card.bg_img}}'); background-position:center; background-repeat:no-repeat; background-size:cover;">
                          {% endif %}
                        {% else %}
                      <ons-card data-card-name="{{card.name}}" style="max-width:{{card.max_width}}%;  margin:0 auto; margin-bottom: 5px;"  modifier="{{data.settings.style}}">
                        {% endif %}
                          <div class="title">
                            {{card.name}}
                          </div>
                            <div>
                              {% if card.use_color%}
                              <ons-list style="background-color: {{card.color}};" modifier="{{card.border}}">
                              {% else %}
                              <ons-list modifier="{{card.border}}">
                              {% endif %}
                                <ons-list-item>
                                    <div class="form_container">
                                      <br />
                                      {{card.html}}
                                    {% if card.form_id != ""%}
                                    <form class="gform" id="form_{{card.name}}" method="post" action="https://script.google.com/s/{{card.form_id}}/exec">
                                      {% if card.use_color%}
                                      <ons-list style="background-color: {{card.color}};">
                                      {% else %}
                                        <ons-list class="form_list">
                                      {% endif %}
                                        {% for input in card.form_data %}
                                        <ons-list-item class="form_list_item">
                                          <ons-input class="form_input" id="{{input}}" name="{{input}}" modifier="underbar" placeholder="{{input}}" float></ons-input>
                                        </ons-list-item>
                                        {% endfor %}
                                      </ons-list>
                                      <button class="form_list button--large button" id="submit" type="submit">{{card.form_btn_txt}}</button>
                                    </form>
                                    {{card.form_html}}
                                  {% else %}
                                  <p>FORM ID IS NOT SET!!!</p>
                                  {% endif %}
                                  </div>
                              </ons-list-item>
                            </ons-list>
                          </div>
                        </ons-card>
                      {% else %}
                      {% if card.bg_img != 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAACXBIWXMAAC4jAAAuIwF4pT92AAAADUlEQVQImWP4//8/AwAI/AL+hc2rNAAAAABJRU5ErkJggg==' %}
                        {% if card.use_color%}
                        <ons-card data-card-name="{{card.name}}" modifier="{{data.settings.style}}" style="max-width:{{card.max_width}}%;  margin:0 auto; margin-bottom: 5px; background-color: {{card.color}}; background: url('{{card.bg_img}}'); background-position:center; background-repeat:no-repeat; background-size:cover;">
                        {% else %}
                        <ons-card data-card-name="{{card.name}}" modifier="{{data.settings.style}}" style="max-width:{{card.max_width}}%;  margin:0 auto; margin-bottom: 5px; background: url('{{card.bg_img}}'); background-position:center; background-repeat:no-repeat; background-size:cover;">
                        {% endif %}
                      {% else %}
                        {% if card.use_color%}
                        <ons-card data-card-name="{{card.name}}" style="max-width:{{card.max_width}}%;  margin:0 auto; margin-bottom: 5px; background-color: {{card.color}};" modifier="{{data.settings.style}}">
                        {% else %}
                        <ons-card data-card-name="{{card.name}}" style="max-width:{{card.max_width}}%;  margin:0 auto; margin-bottom: 5px;" modifier="{{data.settings.style}}">
                        {% endif %}
                      {% endif %}
                        <div class="title">
                          {{card.name}}
                        </div>
                          <div class="content">
                            {% if card.type == 'Expandable' %}
                            <ons-list-item expandable>
                            {% else %}
                            <ons-list-item expandable expanded class="list-item list-item--expandable expanded ">
                            {% endif %}
                            {% if card.use_thumb %}
                              {% if card.author_img != '' %}
                              <div class="left">
                                <img class="list-item__thumbnail" src="{{card.author_img}}">
                                <p class="list-item__subtitle author">{{card.author}}</p>
                              </div>
                                {% endif %}
                              {% endif %}
                              <div class="expandable-content">
                                <div class="article">
                                  <br />
                                  {{card.html}}
                                    {% if card.use_color%}
                                    <ons-list style="background-color: {{card.color}};">
                                    {% else %}
                                    <ons-list>
                                    {% endif %}
                                  </ons-list>
                                  {{card.form_html}}
                                </div>
                                  <ons-fab onclick="myNavigator.pushPage('nav_{{card.name}}.html')" modifier="{{data.settings.style}}">
                                    <ons-icon icon="fa-chevron-left"></ons-icon>
                                  </ons-fab>
                                </div>
                              </ons-list-item>
                            </ons-list>
                          </div>
                        </ons-card>
                      {% endif %}
                      {% endfor %}
                 </ons-col>
              {% endfor %}
             </ons-row>
           </div>
        </div>
      </ons-carousel-item>
      {% endfor %}
    </ons-carousel>
  </ons-page>
</template>
{% endif %}

<!-- Tabs Home Page Template -->
{% if data.settings.pageType == 'tabs' %}
<template id="tabs-home.html">
  <ons-page>
    
    <!-- Hero Section (if configured) -->
    {% if data.homePage.content.hero_title or data.homePage.content.hero_image %}
    <div class="hero-section" {% if data.homePage.content.hero_image %}style="background-image: url('{{data.homePage.content.hero_image}}')"{% endif %}>
      <div class="hero-content">

        {% if data.homePage.content.hero_title %}
        <h1 class="hero-title">{{data.homePage.content.hero_title}}</h1>
        {% endif %}
        {% if data.homePage.content.hero_subtitle %}
        <p class="hero-subtitle">{{data.homePage.content.hero_subtitle}}</p>
        {% endif %}

        {% if data.homePage.content.cta_button.text %}
        <ons-button onclick="fn.goToTabByName('{{data.pages[0].title}}')" modifier="large" class="hero-cta">
          {{data.homePage.content.cta_button.text}}
        </ons-button>
        {% endif %}

        <!-- Navigation Buttons (from frontmatter) -->
        {% if data.homePage.navigation %}
        <div class="home-navigation">
          {% for nav_item in data.homePage.navigation %}
                  {% if data.settings.pageType == 'splitter' %}
                    <ons-button onclick="fn.load('{{nav_item.page}}.html')"
                  {% endif %}
                  {% if data.settings.pageType == 'carousel' %}
                    <ons-button onclick="fn.goToPageByName('{{nav_item.page}}')"
                  {% endif %}
                  {% if data.settings.pageType == 'tabs' %}
                    <ons-button onclick="fn.goToTabByName('{{nav_item.page}}')"
                  {% endif %}
                        modifier="{{nav_item.style or 'primary'}}" 
                        class="home-nav-button {% if nav_item.image %}image-button{% endif %}"
                        title="{{nav_item.text or nav_item.alt or ''}}">
              {% if nav_item.image %}
                <img src="{{nav_item.image}}" alt="{{nav_item.alt or nav_item.text or ''}}" loading="lazy">
              {% endif %}
              {% if nav_item.text and not nav_item.hide_text %}
                <span>{{nav_item.text}}</span>
              {% endif %}
            </ons-button>
          {% endfor %}
        </div>
        {% endif %}

        {% if data.homePage.content.features %}
          <div class="features-section">
            <div class="features">
              {% for feature in data.homePage.content.features %}
              <div class="feature-card">
                <h3>
                  <span class="feature-icon">{{ feature.title.split(' ')[0] }}</span>
                  {{ feature.title.split(' ')[1:]|join(' ') }}
                </h3>
                <p>{{ feature.details }}</p>
              </div>
              {% endfor %}
            </div>
          </div>
          
        {% endif %}
      </div>
    </div>
    {% endif %}
    
    <!-- Main Content (processed markdown) -->
    <div class="home-content">
      {{data.homePage.content.html|safe}}
    </div>
  </ons-page>
</template>
{% endif %}

<!-- Home Page Template (for splitter mode only) -->
{% if data.hasHomePage and data.settings.pageType == 'splitter' %}
<template id="home.html">
  <ons-page>

    <ons-toolbar modifier="{{data.settings.style}}">
    {% if data.settings.pageType == 'splitter' %}
      <div class="left">
        <ons-toolbar-button onclick="fn.open()" modifier="{{data.settings.style}}">
          
          {% if data.settings.siteLogo %}
          <img src="{{data.settings.siteLogo}}" 
              alt="{{data.settings.siteName}} Logo" 
              style="height: 32px; width: auto; max-width: 120px; object-fit: contain; margin-right: 10px; margin-left: 10px;">
          {% else %}
          <ons-icon icon="md-menu"></ons-icon>
          {% endif %}
        </ons-toolbar-button>
      </div>
    
    {% endif %}
    </ons-toolbar>
    
    <!-- Hero Section (if configured) -->
    {% if data.homePage.content.hero_title or data.homePage.content.hero_image %}
    <div class="hero-section" {% if data.homePage.content.hero_image %}style="background-image: url('{{data.homePage.content.hero_image}}')"{% endif %}>
      <div class="hero-content">

        {% if data.homePage.content.hero_title %}
        <h1 class="hero-title">{{data.homePage.content.hero_title}}</h1>
        {% endif %}
        {% if data.homePage.content.hero_subtitle %}
        <p class="hero-subtitle">{{data.homePage.content.hero_subtitle}}</p>
        {% endif %}

        {% if data.homePage.content.cta_button.text %}
        <ons-button onclick="fn.load('{{data.pages[0].title}}.html')" modifier="large" class="hero-cta">
          {{data.homePage.content.cta_button.text}}
        </ons-button>
        {% endif %}

        <!-- Navigation Buttons (from frontmatter) -->
        {% if data.homePage.navigation %}
        <div class="home-navigation">
          {% for nav_item in data.homePage.navigation %}
                  {% if data.settings.pageType == 'splitter' %}
                    <ons-button onclick="fn.load('{{nav_item.page}}.html')"
                  {% endif %}
                  {% if data.settings.pageType == 'carousel' %}
                    <ons-button onclick="fn.goToPageByName('{{nav_item.page}}')"
                  {% endif %}
                  {% if data.settings.pageType == 'tabs' %}
                    <ons-button onclick="fn.goToTabByName('{{nav_item.page}}')"
                  {% endif %}
                        modifier="{{nav_item.style or 'primary'}}" 
                        class="home-nav-button {% if nav_item.image %}image-button{% endif %}"
                        title="{{nav_item.text or nav_item.alt or ''}}">
              {% if nav_item.image %}
                <img src="{{nav_item.image}}" alt="{{nav_item.alt or nav_item.text or ''}}" loading="lazy">
              {% endif %}
              {% if nav_item.text and not nav_item.hide_text %}
                <span>{{nav_item.text}}</span>
              {% endif %}
            </ons-button>
          {% endfor %}
        </div>
        {% endif %}

        <!-- Feature Cards Section -->
        {% if data.homePage.content.features %}
        <div class="features-section">
          <div class="features">
            {% for feature in data.homePage.content.features %}
            <div class="feature-card">
              <h3>
                <span class="feature-icon">{{ feature.title.split(' ')[0] }}</span>
                {{ feature.title.split(' ')[1:]|join(' ') }}
              </h3>
              <p>{{ feature.details }}</p>
            </div>
          {% endfor %}

          </div>
        </div>
        {% endif %}
      </div>
    </div>
    {% endif %}
    
    <!-- Main Content (processed markdown) -->
    <div class="home-content">
      {{data.homePage.content.html|safe}}
    </div>
  </ons-page>
</template>
{% endif %}

<!-- Regular Page Templates -->
{% for page in data.pages %}
<template id="{{page.title}}.html">
  <ons-page>
    <ons-toolbar modifier="{{data.settings.style}}">
      {% if data.settings.pageType == 'splitter' %}
      <div class="left">
        <ons-toolbar-button onclick="fn.open()" modifier="{{data.settings.style}}">
        {% if data.settings.siteLogo %}
          <img src="{{data.settings.siteLogo}}" 
              alt="{{data.settings.siteName}} Logo" 
              style="height: 32px; width: auto; max-width: 120px; object-fit: contain; margin-right: 10px; margin-left: 10px;">
        {% else %}
          <ons-icon icon="md-menu"></ons-icon>
        {% endif %}
        </ons-toolbar-button>
        
      </div>
      {% endif %}
    </ons-toolbar>
    <div style="text-align: center">
      <ons-row>
        {% for column in page.content.columns %}
           <ons-col width="{{page.content.widths[loop.index0]}}%">
                {% for card in column %}
                {% if card.type == 'Form' %}
                  {% if card.bg_img != 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAACXBIWXMAAC4jAAAuIwF4pT92AAAADUlEQVQImWP4//8/AwAI/AL+hc2rNAAAAABJRU5ErkJggg==' %}
                    {% if card.use_color%}
                    <ons-card data-card-name="{{card.name}}" style="max-width:{{card.max_width}}%;  margin:0 auto; margin-bottom: 5px;"  modifier="{{data.settings.style}}" style="background-color: {{card.color}}; background: url('{{card.bg_img}}'); background-position:center; background-repeat:no-repeat; background-size:cover;">
                    {% else %}
                    <ons-card data-card-name="{{card.name}}" modifier="{{data.settings.style}}" style="max-width:{{card.max_width}}%;  margin:0 auto; margin-bottom: 5px; background: url('{{card.bg_img}}'); background-position:center; background-repeat:no-repeat; background-size:cover;">
                    {% endif %}
                  {% else %}
                <ons-card data-card-name="{{card.name}}" style="max-width:{{card.max_width}}%;  margin:0 auto; margin-bottom: 5px;"  modifier="{{data.settings.style}}">
                  {% endif %}
                    <div class="title">
                      {{card.name}}
                    </div>
                      <div>
                        {% if card.use_color%}
                        <ons-list style="background-color: {{card.color}};" modifier="{{card.border}}">
                        {% else %}
                        <ons-list modifier="{{card.border}}">
                        {% endif %}
                          <ons-list-item>
                              <div class="form_container">
                                <br />
                                {{card.html}}
                              {% if card.form_id != ""%}
                              <form class="gform" id="form_{{card.name}}" method="post" action="https://script.google.com/macros/s/{{card.form_id}}/exec">
                                {% if card.use_color%}
                                <ons-list style="background-color: {{card.color}};">
                                {% else %}
                                  <ons-list class="form_list">
                                {% endif %}
                                  {% for input in card.form_data %}
                                  <ons-list-item class="form_list_item">
                                    <ons-input class="form_input" id="{{input}}" name="{{input}}" modifier="underbar" placeholder="{{input}}" float></ons-input>
                                  </ons-list-item>
                                  {% endfor %}
                                </ons-list>
                                <button class="form_list button--large button" id="submit" type="submit">{{card.form_btn_txt}}</button>
                                </form>
                                {{card.form_html}}
                              {% else %}
                              <p>FORM ID IS NOT SET!!!</p>
                              {% endif %}
                              </div>
                          </ons-list-item>
                        </ons-list>
                      </div>
                    </ons-card>
                {% else %}
                {% if card.bg_img != 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAACXBIWXMAAC4jAAAuIwF4pT92AAAADUlEQVQImWP4//8/AwAI/AL+hc2rNAAAAABJRU5ErkJggg==' %}
                    {% if card.use_color%}
                    <ons-card data-card-name="{{card.name}}" modifier="{{data.settings.style}}" style="max-width:{{card.max_width}}%;  margin:0 auto; margin-bottom: 5px; background-color: {{card.color}}; background: url('{{card.bg_img}}'); background-position:center; background-repeat:no-repeat; background-size:cover;">
                    {% else %}
                    <ons-card data-card-name="{{card.name}}" modifier="{{data.settings.style}}" style="max-width:{{card.max_width}}%;  margin:0 auto; margin-bottom: 5px; background: url('{{card.bg_img}}'); background-position:center; background-repeat:no-repeat; background-size:cover;">
                    {% endif %}
                  {% else %}
                    {% if card.use_color%}
                    <ons-card data-card-name="{{card.name}}" style="max-width:{{card.max_width}}%;  margin:0 auto; margin-bottom: 5px; background-color: {{card.color}};" modifier="{{data.settings.style}}">
                    {% else %}
                    <ons-card data-card-name="{{card.name}}" style="max-width:{{card.max_width}}%;  margin:0 auto; margin-bottom: 5px;" modifier="{{data.settings.style}}">
                    {% endif %}
                  {% endif %}
                    <div class="title">
                      {{card.name}}
                    </div>
                      <div class="content">
                        {% if card.use_color%}
                        <ons-list style="background-color: {{card.color}};" modifier="{{card.border}}">
                        {% else %}
                        <ons-list modifier="{{card.border}}">
                        {% endif %}
                          {% if card.type == 'Expandable' %}
                          <ons-list-item expandable>
                          {% else %}
                          <ons-list-item expandable expanded class="list-item list-item--expandable expanded ">
                          {% endif %}
                          {% if card.use_thumb %}
                            {% if card.author_img != '' %}
                            <div class="left">
                              <img class="list-item__thumbnail" src="{{card.author_img}}">
                              <p class="list-item__subtitle author">{{card.author}}</p>
                            </div>
                              {% endif %}
                            {% endif %}
                            <div class="expandable-content">
                              <div class="article">
                                <br />
                                {{card.html}}
                                  {% if card.use_color%}
                                  <ons-list style="background-color: {{card.color}};">
                                  {% else %}
                                  <ons-list>
                                  {% endif %}
                                </ons-list>
                                {{card.form_html}}
                              </div>
                               <ons-fab onclick="myNavigator.pushPage('nav_{{card.name}}.html')" modifier="{{data.settings.style}}">
                                 <ons-icon icon="fa-chevron-left"></ons-icon>
                               </ons-fab>
                             </div>
                           </ons-list-item>
                         </ons-list>
                       </div>
                     </ons-card>
                {% endif %}
                {% endfor %}
           </ons-col>
        {% endfor %}
       </ons-row>
    </div>
  </ons-page>
</template>
{% endfor %}

{% for page in data.pages %}
{% for column in page.content.columns %}
{% for card in column %}
  {% if card.type == 'Form' %}
  <template id="dlg_{{card.name}}.html">
  <ons-dialog id="dlg_{{card.name}}">
    <div style="text-align: center; padding: 10px;">
      <p>
        {{card.form_response}}
      </p>

      <p>
        <ons-button onclick="fn.hideDialog('dlg_{{card.name}}')">Close</ons-button>
      </p>
    </div>
  </ons-dialog>
</template>
  {% else %}
  <template id="nav_{{card.name}}.html">
  <ons-page id="nav_{{card.name}}">
    {% if card.bg_img != 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAACXBIWXMAAC4jAAAuIwF4pT92AAAADUlEQVQImWP4//8/AwAI/AL+hc2rNAAAAABJRU5ErkJggg==' %}
    <div style="background: url('{{card.bg_img}}'); background-position:center; background-repeat:repeat; background-size:cover;">
    {% else %}
    <div>
    {% endif %}
    <ons-toolbar modifier="{{data.settings.style}}">
      <div class="left">
        <ons-back-button modifier="{{data.settings.style}}">Back</ons-back-button>
      </div>
      <div class="left">
      {% if data.settings.pageType == 'splitter' %}
        <ons-toolbar-button onclick="fn.open()" modifier="{{data.settings.style}}">
          <ons-icon icon="md-menu"></ons-icon>
        </ons-toolbar-button>
      {% endif %}
      {% if data.settings.pageType == 'carousel' %}
        {% if data.settings.siteLogo %}
            <img src="{{data.settings.siteLogo}}"
                onclick="fn.load('carousel-home.html')"
                alt="{{data.settings.siteName}} Logo" 
                style="height: 32px; width: auto; max-width: 120px; object-fit: contain; margin-right: 10px; margin-left: 10px;">
        {% else %}
        <ons-toolbar-button onclick="fn.load('carousel-home.html')">
            <ons-icon icon="md-home"></ons-icon>
        </ons-toolbar-button>
        {% endif %}
        
      {% endif %}
      </div>
    </ons-toolbar>

    <div class="expanded_article_div" style="text-align: center; background-color: rgba({{card.rgb[0]}}, {{card.rgb[1]}}, {{card.rgb[2]}}, {{card.bg_img_opacity}});">
        <h1 class="article-title">{{card.name}}</h1>
        <br />
          <div class="expanded_article">
            <br />
            {{card.html}}
            <ons-list>
            {% for input in card.form_data %}
            <ons-list-item>
              <ons-input id="{{input}}" modifier="underbar" placeholder="{{input}}" float></ons-input>
            </ons-list-item>
            {% endfor %}
            </ons-list>
          </div>
      </div>
    </div>
  </ons-page>
</template>
  {% endif %}
{% endfor %}
{% endfor %}
{% endfor %}

<template id="loading.html">
  <ons-dialog id="loading">
    <div style="text-align: center; padding: 10px;">
      <p>
        <ons-progress-circular indeterminate></ons-progress-circular>
      </p>
    </div>
  </ons-dialog>
</template>

<!-- partial -->
<!-- <script  src="./script.js"></script> -->

</body>
</html>
